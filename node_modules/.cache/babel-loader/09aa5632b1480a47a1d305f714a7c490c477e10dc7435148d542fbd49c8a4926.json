{"ast":null,"code":"import { Encodings, Font, FontNames } from '@pdf-lib/standard-fonts';\nimport PDFHexString from \"../objects/PDFHexString\";\nimport { toCodePoint, toHexString } from \"../../utils\";\n/**\r\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\r\n * this class borrows from:\r\n *   https://github.com/foliojs/pdfkit/blob/f91bdd61c164a72ea06be1a43dc0a412afc3925f/lib/font/afm.coffee\r\n */\nvar StandardFontEmbedder = /** @class */function () {\n  function StandardFontEmbedder(fontName, customName) {\n    // prettier-ignore\n    this.encoding = fontName === FontNames.ZapfDingbats ? Encodings.ZapfDingbats : fontName === FontNames.Symbol ? Encodings.Symbol : Encodings.WinAnsi;\n    this.font = Font.load(fontName);\n    this.fontName = this.font.FontName;\n    this.customName = customName;\n  }\n  /**\r\n   * Encode the JavaScript string into this font. (JavaScript encodes strings in\r\n   * Unicode, but standard fonts use either WinAnsi, ZapfDingbats, or Symbol\r\n   * encodings)\r\n   */\n  StandardFontEmbedder.prototype.encodeText = function (text) {\n    var glyphs = this.encodeTextAsGlyphs(text);\n    var hexCodes = new Array(glyphs.length);\n    for (var idx = 0, len = glyphs.length; idx < len; idx++) {\n      hexCodes[idx] = toHexString(glyphs[idx].code);\n    }\n    return PDFHexString.of(hexCodes.join(''));\n  };\n  StandardFontEmbedder.prototype.widthOfTextAtSize = function (text, size) {\n    var glyphs = this.encodeTextAsGlyphs(text);\n    var totalWidth = 0;\n    for (var idx = 0, len = glyphs.length; idx < len; idx++) {\n      var left = glyphs[idx].name;\n      var right = (glyphs[idx + 1] || {}).name;\n      var kernAmount = this.font.getXAxisKerningForPair(left, right) || 0;\n      totalWidth += this.widthOfGlyph(left) + kernAmount;\n    }\n    var scale = size / 1000;\n    return totalWidth * scale;\n  };\n  StandardFontEmbedder.prototype.heightOfFontAtSize = function (size, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    var _a = options.descender,\n      descender = _a === void 0 ? true : _a;\n    var _b = this.font,\n      Ascender = _b.Ascender,\n      Descender = _b.Descender,\n      FontBBox = _b.FontBBox;\n    var yTop = Ascender || FontBBox[3];\n    var yBottom = Descender || FontBBox[1];\n    var height = yTop - yBottom;\n    if (!descender) height += Descender || 0;\n    return height / 1000 * size;\n  };\n  StandardFontEmbedder.prototype.sizeOfFontAtHeight = function (height) {\n    var _a = this.font,\n      Ascender = _a.Ascender,\n      Descender = _a.Descender,\n      FontBBox = _a.FontBBox;\n    var yTop = Ascender || FontBBox[3];\n    var yBottom = Descender || FontBBox[1];\n    return 1000 * height / (yTop - yBottom);\n  };\n  StandardFontEmbedder.prototype.embedIntoContext = function (context, ref) {\n    var fontDict = context.obj({\n      Type: 'Font',\n      Subtype: 'Type1',\n      BaseFont: this.customName || this.fontName,\n      Encoding: this.encoding === Encodings.WinAnsi ? 'WinAnsiEncoding' : undefined\n    });\n    if (ref) {\n      context.assign(ref, fontDict);\n      return ref;\n    } else {\n      return context.register(fontDict);\n    }\n  };\n  StandardFontEmbedder.prototype.widthOfGlyph = function (glyphName) {\n    // Default to 250 if font doesn't specify a width\n    return this.font.getWidthOfGlyph(glyphName) || 250;\n  };\n  StandardFontEmbedder.prototype.encodeTextAsGlyphs = function (text) {\n    var codePoints = Array.from(text);\n    var glyphs = new Array(codePoints.length);\n    for (var idx = 0, len = codePoints.length; idx < len; idx++) {\n      var codePoint = toCodePoint(codePoints[idx]);\n      glyphs[idx] = this.encoding.encodeUnicodeCodePoint(codePoint);\n    }\n    return glyphs;\n  };\n  StandardFontEmbedder.for = function (fontName, customName) {\n    return new StandardFontEmbedder(fontName, customName);\n  };\n  return StandardFontEmbedder;\n}();\nexport default StandardFontEmbedder;","map":{"version":3,"names":["Encodings","Font","FontNames","PDFHexString","toCodePoint","toHexString","StandardFontEmbedder","fontName","customName","encoding","ZapfDingbats","Symbol","WinAnsi","font","load","FontName","prototype","encodeText","text","glyphs","encodeTextAsGlyphs","hexCodes","Array","length","idx","len","code","of","join","widthOfTextAtSize","size","totalWidth","left","name","right","kernAmount","getXAxisKerningForPair","widthOfGlyph","scale","heightOfFontAtSize","options","_a","descender","_b","Ascender","Descender","FontBBox","yTop","yBottom","height","sizeOfFontAtHeight","embedIntoContext","context","ref","fontDict","obj","Type","Subtype","BaseFont","Encoding","undefined","assign","register","glyphName","getWidthOfGlyph","codePoints","from","codePoint","encodeUnicodeCodePoint","for"],"sources":["C:\\Users\\TongNPZ\\Desktop\\my-app-2.0 - Copy (2)\\node_modules\\pdf-lib\\src\\core\\embedders\\StandardFontEmbedder.ts"],"sourcesContent":["import {\r\n  Encodings,\r\n  Font,\r\n  FontNames,\r\n  EncodingType,\r\n} from '@pdf-lib/standard-fonts';\r\n\r\nimport PDFHexString from 'src/core/objects/PDFHexString';\r\nimport PDFRef from 'src/core/objects/PDFRef';\r\nimport PDFContext from 'src/core/PDFContext';\r\nimport { toCodePoint, toHexString } from 'src/utils';\r\n\r\nexport interface Glyph {\r\n  code: number;\r\n  name: string;\r\n}\r\n\r\n/**\r\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\r\n * this class borrows from:\r\n *   https://github.com/foliojs/pdfkit/blob/f91bdd61c164a72ea06be1a43dc0a412afc3925f/lib/font/afm.coffee\r\n */\r\nclass StandardFontEmbedder {\r\n  static for = (fontName: FontNames, customName?: string) =>\r\n    new StandardFontEmbedder(fontName, customName);\r\n\r\n  readonly font: Font;\r\n  readonly encoding: EncodingType;\r\n  readonly fontName: string;\r\n  readonly customName: string | undefined;\r\n\r\n  private constructor(fontName: FontNames, customName?: string) {\r\n    // prettier-ignore\r\n    this.encoding = (\r\n        fontName === FontNames.ZapfDingbats ? Encodings.ZapfDingbats\r\n      : fontName === FontNames.Symbol       ? Encodings.Symbol\r\n      : Encodings.WinAnsi\r\n    );\r\n    this.font = Font.load(fontName);\r\n    this.fontName = this.font.FontName;\r\n    this.customName = customName;\r\n  }\r\n\r\n  /**\r\n   * Encode the JavaScript string into this font. (JavaScript encodes strings in\r\n   * Unicode, but standard fonts use either WinAnsi, ZapfDingbats, or Symbol\r\n   * encodings)\r\n   */\r\n  encodeText(text: string): PDFHexString {\r\n    const glyphs = this.encodeTextAsGlyphs(text);\r\n    const hexCodes = new Array(glyphs.length);\r\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\r\n      hexCodes[idx] = toHexString(glyphs[idx].code);\r\n    }\r\n    return PDFHexString.of(hexCodes.join(''));\r\n  }\r\n\r\n  widthOfTextAtSize(text: string, size: number): number {\r\n    const glyphs = this.encodeTextAsGlyphs(text);\r\n    let totalWidth = 0;\r\n\r\n    for (let idx = 0, len = glyphs.length; idx < len; idx++) {\r\n      const left = glyphs[idx].name;\r\n      const right = (glyphs[idx + 1] || {}).name;\r\n      const kernAmount = this.font.getXAxisKerningForPair(left, right) || 0;\r\n      totalWidth += this.widthOfGlyph(left) + kernAmount;\r\n    }\r\n\r\n    const scale = size / 1000;\r\n    return totalWidth * scale;\r\n  }\r\n\r\n  heightOfFontAtSize(\r\n    size: number,\r\n    options: { descender?: boolean } = {},\r\n  ): number {\r\n    const { descender = true } = options;\r\n\r\n    const { Ascender, Descender, FontBBox } = this.font;\r\n    const yTop = Ascender || FontBBox[3];\r\n    const yBottom = Descender || FontBBox[1];\r\n\r\n    let height = yTop - yBottom;\r\n    if (!descender) height += Descender || 0;\r\n\r\n    return (height / 1000) * size;\r\n  }\r\n\r\n  sizeOfFontAtHeight(height: number): number {\r\n    const { Ascender, Descender, FontBBox } = this.font;\r\n    const yTop = Ascender || FontBBox[3];\r\n    const yBottom = Descender || FontBBox[1];\r\n    return (1000 * height) / (yTop - yBottom);\r\n  }\r\n\r\n  embedIntoContext(context: PDFContext, ref?: PDFRef): PDFRef {\r\n    const fontDict = context.obj({\r\n      Type: 'Font',\r\n      Subtype: 'Type1',\r\n      BaseFont: this.customName || this.fontName,\r\n\r\n      Encoding:\r\n        this.encoding === Encodings.WinAnsi ? 'WinAnsiEncoding' : undefined,\r\n    });\r\n\r\n    if (ref) {\r\n      context.assign(ref, fontDict);\r\n      return ref;\r\n    } else {\r\n      return context.register(fontDict);\r\n    }\r\n  }\r\n\r\n  private widthOfGlyph(glyphName: string): number {\r\n    // Default to 250 if font doesn't specify a width\r\n    return this.font.getWidthOfGlyph(glyphName) || 250;\r\n  }\r\n\r\n  private encodeTextAsGlyphs(text: string): Glyph[] {\r\n    const codePoints = Array.from(text);\r\n    const glyphs: Glyph[] = new Array(codePoints.length);\r\n    for (let idx = 0, len = codePoints.length; idx < len; idx++) {\r\n      const codePoint = toCodePoint(codePoints[idx])!;\r\n      glyphs[idx] = this.encoding.encodeUnicodeCodePoint(codePoint);\r\n    }\r\n    return glyphs;\r\n  }\r\n}\r\n\r\nexport default StandardFontEmbedder;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}