{"ast":null,"code":"import { __extends } from \"tslib\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFNumber from \"../objects/PDFNumber\";\nimport PDFFlateStream from \"./PDFFlateStream\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { copyStringIntoBuffer, last } from \"../../utils\";\nvar PDFObjectStream = /** @class */function (_super) {\n  __extends(PDFObjectStream, _super);\n  function PDFObjectStream(context, objects, encode) {\n    if (encode === void 0) {\n      encode = true;\n    }\n    var _this = _super.call(this, context.obj({}), encode) || this;\n    _this.objects = objects;\n    _this.offsets = _this.computeObjectOffsets();\n    _this.offsetsString = _this.computeOffsetsString();\n    _this.dict.set(PDFName.of('Type'), PDFName.of('ObjStm'));\n    _this.dict.set(PDFName.of('N'), PDFNumber.of(_this.objects.length));\n    _this.dict.set(PDFName.of('First'), PDFNumber.of(_this.offsetsString.length));\n    return _this;\n  }\n  PDFObjectStream.prototype.getObjectsCount = function () {\n    return this.objects.length;\n  };\n  PDFObjectStream.prototype.clone = function (context) {\n    return PDFObjectStream.withContextAndObjects(context || this.dict.context, this.objects.slice(), this.encode);\n  };\n  PDFObjectStream.prototype.getContentsString = function () {\n    var value = this.offsetsString;\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        object = _a[1];\n      value += object + \"\\n\";\n    }\n    return value;\n  };\n  PDFObjectStream.prototype.getUnencodedContents = function () {\n    var buffer = new Uint8Array(this.getUnencodedContentsSize());\n    var offset = copyStringIntoBuffer(this.offsetsString, buffer, 0);\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        object = _a[1];\n      offset += object.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n    return buffer;\n  };\n  PDFObjectStream.prototype.getUnencodedContentsSize = function () {\n    return this.offsetsString.length + last(this.offsets)[1] + last(this.objects)[1].sizeInBytes() + 1;\n  };\n  PDFObjectStream.prototype.computeOffsetsString = function () {\n    var offsetsString = '';\n    for (var idx = 0, len = this.offsets.length; idx < len; idx++) {\n      var _a = this.offsets[idx],\n        objectNumber = _a[0],\n        offset = _a[1];\n      offsetsString += objectNumber + \" \" + offset + \" \";\n    }\n    return offsetsString;\n  };\n  PDFObjectStream.prototype.computeObjectOffsets = function () {\n    var offset = 0;\n    var offsets = new Array(this.objects.length);\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        ref = _a[0],\n        object = _a[1];\n      offsets[idx] = [ref.objectNumber, offset];\n      offset += object.sizeInBytes() + 1; // '\\n'\n    }\n\n    return offsets;\n  };\n  PDFObjectStream.withContextAndObjects = function (context, objects, encode) {\n    if (encode === void 0) {\n      encode = true;\n    }\n    return new PDFObjectStream(context, objects, encode);\n  };\n  return PDFObjectStream;\n}(PDFFlateStream);\nexport default PDFObjectStream;","map":{"version":3,"names":["PDFName","PDFNumber","PDFFlateStream","CharCodes","copyStringIntoBuffer","last","PDFObjectStream","_super","__extends","context","objects","encode","_this","call","obj","offsets","computeObjectOffsets","offsetsString","computeOffsetsString","dict","set","of","length","prototype","getObjectsCount","clone","withContextAndObjects","slice","getContentsString","value","idx","len","_a","object","getUnencodedContents","buffer","Uint8Array","getUnencodedContentsSize","offset","copyBytesInto","Newline","sizeInBytes","objectNumber","Array","ref"],"sources":["C:\\Users\\TongNPZ\\Desktop\\my-app-2.0 - Copy (2)\\node_modules\\pdf-lib\\src\\core\\structures\\PDFObjectStream.ts"],"sourcesContent":["import PDFName from 'src/core/objects/PDFName';\r\nimport PDFNumber from 'src/core/objects/PDFNumber';\r\nimport PDFObject from 'src/core/objects/PDFObject';\r\nimport PDFRef from 'src/core/objects/PDFRef';\r\nimport PDFContext from 'src/core/PDFContext';\r\nimport PDFFlateStream from 'src/core/structures/PDFFlateStream';\r\nimport CharCodes from 'src/core/syntax/CharCodes';\r\nimport { copyStringIntoBuffer, last } from 'src/utils';\r\n\r\nexport type IndirectObject = [PDFRef, PDFObject];\r\n\r\nclass PDFObjectStream extends PDFFlateStream {\r\n  static withContextAndObjects = (\r\n    context: PDFContext,\r\n    objects: IndirectObject[],\r\n    encode = true,\r\n  ) => new PDFObjectStream(context, objects, encode);\r\n\r\n  private readonly objects: IndirectObject[];\r\n  private readonly offsets: [number, number][];\r\n  private readonly offsetsString: string;\r\n\r\n  private constructor(\r\n    context: PDFContext,\r\n    objects: IndirectObject[],\r\n    encode = true,\r\n  ) {\r\n    super(context.obj({}), encode);\r\n\r\n    this.objects = objects;\r\n    this.offsets = this.computeObjectOffsets();\r\n    this.offsetsString = this.computeOffsetsString();\r\n\r\n    this.dict.set(PDFName.of('Type'), PDFName.of('ObjStm'));\r\n    this.dict.set(PDFName.of('N'), PDFNumber.of(this.objects.length));\r\n    this.dict.set(PDFName.of('First'), PDFNumber.of(this.offsetsString.length));\r\n  }\r\n\r\n  getObjectsCount(): number {\r\n    return this.objects.length;\r\n  }\r\n\r\n  clone(context?: PDFContext): PDFObjectStream {\r\n    return PDFObjectStream.withContextAndObjects(\r\n      context || this.dict.context,\r\n      this.objects.slice(),\r\n      this.encode,\r\n    );\r\n  }\r\n\r\n  getContentsString(): string {\r\n    let value = this.offsetsString;\r\n    for (let idx = 0, len = this.objects.length; idx < len; idx++) {\r\n      const [, object] = this.objects[idx];\r\n      value += `${object}\\n`;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  getUnencodedContents(): Uint8Array {\r\n    const buffer = new Uint8Array(this.getUnencodedContentsSize());\r\n    let offset = copyStringIntoBuffer(this.offsetsString, buffer, 0);\r\n    for (let idx = 0, len = this.objects.length; idx < len; idx++) {\r\n      const [, object] = this.objects[idx];\r\n      offset += object.copyBytesInto(buffer, offset);\r\n      buffer[offset++] = CharCodes.Newline;\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  getUnencodedContentsSize(): number {\r\n    return (\r\n      this.offsetsString.length +\r\n      last(this.offsets)[1] +\r\n      last(this.objects)[1].sizeInBytes() +\r\n      1\r\n    );\r\n  }\r\n\r\n  private computeOffsetsString(): string {\r\n    let offsetsString = '';\r\n    for (let idx = 0, len = this.offsets.length; idx < len; idx++) {\r\n      const [objectNumber, offset] = this.offsets[idx];\r\n      offsetsString += `${objectNumber} ${offset} `;\r\n    }\r\n    return offsetsString;\r\n  }\r\n\r\n  private computeObjectOffsets(): [number, number][] {\r\n    let offset = 0;\r\n    const offsets = new Array(this.objects.length);\r\n    for (let idx = 0, len = this.objects.length; idx < len; idx++) {\r\n      const [ref, object] = this.objects[idx];\r\n      offsets[idx] = [ref.objectNumber, offset];\r\n      offset += object.sizeInBytes() + 1; // '\\n'\r\n    }\r\n    return offsets;\r\n  }\r\n}\r\n\r\nexport default PDFObjectStream;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}