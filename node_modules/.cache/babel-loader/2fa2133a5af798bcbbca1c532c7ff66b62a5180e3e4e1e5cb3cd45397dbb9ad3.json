{"ast":null,"code":"import axios from 'axios';\nconst loginUser = async (username, password, setStatus, setIsLoggedIn) => {\n  try {\n    const response = await axios.post(\"http://26.90.237.200:3000/login\", {\n      username,\n      password\n    });\n    const settoken = response.data.token;\n    localStorage.setItem('token', settoken);\n    const token = localStorage.getItem('token');\n    const config = {\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      }\n    };\n    const authResponse = await axios.post('http://26.90.237.200:3000/authen', {\n      username,\n      password\n    }, config);\n    if ([1, 2, 3].includes(authResponse.data.decoded.statusAuthen)) {\n      const userStatus = authResponse.data.decoded.statusAuthen;\n      localStorage.setItem('userStatus', userStatus);\n      setStatus(userStatus);\n      setIsLoggedIn(true);\n      setUser(username); // ที่นี่เราเก็บ username ใน context\n      alert('Authen success');\n      return {\n        status: userStatus,\n        auth: true\n      };\n    } else {\n      localStorage.removeItem('userStatus');\n      setStatus(null);\n      setIsLoggedIn(false);\n      alert('Authen failed');\n      return {\n        status: null,\n        auth: false\n      };\n    }\n  } catch (error) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('userStatus');\n    setStatus(null);\n    setIsLoggedIn(false);\n    alert('Authen error');\n    console.error(error);\n    return {\n      status: null,\n      auth: false\n    };\n  }\n};\nexport default loginUser;","map":{"version":3,"names":["axios","loginUser","username","password","setStatus","setIsLoggedIn","response","post","settoken","data","token","localStorage","setItem","getItem","config","headers","authResponse","includes","decoded","statusAuthen","userStatus","setUser","alert","status","auth","removeItem","error","console"],"sources":["C:/Users/TongNPZ/Desktop/my-app-2.0/src/components/Login/Login.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst loginUser = async (username, password, setStatus, setIsLoggedIn) => {\r\n  try {\r\n    const response = await axios.post(\"http://26.90.237.200:3000/login\", { username, password });\r\n    const settoken = response.data.token;\r\n    localStorage.setItem('token', settoken);\r\n\r\n    const token = localStorage.getItem('token');\r\n    const config = {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    };\r\n\r\n    const authResponse = await axios.post('http://26.90.237.200:3000/authen', { username, password },config);\r\n    if ([1, 2, 3].includes(authResponse.data.decoded.statusAuthen)) {\r\n      const userStatus = authResponse.data.decoded.statusAuthen;\r\n      localStorage.setItem('userStatus', userStatus);\r\n      setStatus(userStatus);\r\n      setIsLoggedIn(true);\r\n      setUser(username);  // ที่นี่เราเก็บ username ใน context\r\n      alert('Authen success');\r\n      return { status: userStatus, auth: true };\r\n      \r\n    } else {\r\n      localStorage.removeItem('userStatus');\r\n      setStatus(null);\r\n      setIsLoggedIn(false);\r\n      alert('Authen failed');\r\n      return { status: null, auth: false };\r\n    }\r\n    \r\n  } catch (error) {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('userStatus');\r\n    setStatus(null);\r\n    setIsLoggedIn(false);\r\n    alert('Authen error');\r\n    console.error(error);\r\n    return { status: null, auth: false };\r\n  }\r\n};\r\n\r\nexport default loginUser;\r\n\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,SAAS,GAAG,MAAAA,CAAOC,QAAQ,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,aAAa,KAAK;EACxE,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMN,KAAK,CAACO,IAAI,CAAC,iCAAiC,EAAE;MAAEL,QAAQ;MAAEC;IAAS,CAAC,CAAC;IAC5F,MAAMK,QAAQ,GAAGF,QAAQ,CAACG,IAAI,CAACC,KAAK;IACpCC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEJ,QAAQ,CAAC;IAEvC,MAAME,KAAK,GAAGC,YAAY,CAACE,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,MAAM,GAAG;MACbC,OAAO,EAAE;QACP,eAAe,EAAG,UAASL,KAAM,EAAC;QAClC,cAAc,EAAE;MAClB;IACF,CAAC;IAED,MAAMM,YAAY,GAAG,MAAMhB,KAAK,CAACO,IAAI,CAAC,kCAAkC,EAAE;MAAEL,QAAQ;MAAEC;IAAS,CAAC,EAACW,MAAM,CAAC;IACxG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAACG,QAAQ,CAACD,YAAY,CAACP,IAAI,CAACS,OAAO,CAACC,YAAY,CAAC,EAAE;MAC9D,MAAMC,UAAU,GAAGJ,YAAY,CAACP,IAAI,CAACS,OAAO,CAACC,YAAY;MACzDR,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEQ,UAAU,CAAC;MAC9ChB,SAAS,CAACgB,UAAU,CAAC;MACrBf,aAAa,CAAC,IAAI,CAAC;MACnBgB,OAAO,CAACnB,QAAQ,CAAC,CAAC,CAAE;MACpBoB,KAAK,CAAC,gBAAgB,CAAC;MACvB,OAAO;QAAEC,MAAM,EAAEH,UAAU;QAAEI,IAAI,EAAE;MAAK,CAAC;IAE3C,CAAC,MAAM;MACLb,YAAY,CAACc,UAAU,CAAC,YAAY,CAAC;MACrCrB,SAAS,CAAC,IAAI,CAAC;MACfC,aAAa,CAAC,KAAK,CAAC;MACpBiB,KAAK,CAAC,eAAe,CAAC;MACtB,OAAO;QAAEC,MAAM,EAAE,IAAI;QAAEC,IAAI,EAAE;MAAM,CAAC;IACtC;EAEF,CAAC,CAAC,OAAOE,KAAK,EAAE;IACdf,YAAY,CAACc,UAAU,CAAC,OAAO,CAAC;IAChCd,YAAY,CAACc,UAAU,CAAC,YAAY,CAAC;IACrCrB,SAAS,CAAC,IAAI,CAAC;IACfC,aAAa,CAAC,KAAK,CAAC;IACpBiB,KAAK,CAAC,cAAc,CAAC;IACrBK,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACpB,OAAO;MAAEH,MAAM,EAAE,IAAI;MAAEC,IAAI,EAAE;IAAM,CAAC;EACtC;AACF,CAAC;AAED,eAAevB,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}