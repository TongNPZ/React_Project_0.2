{"ast":null,"code":"// import React, { useEffect, useState } from 'react';\n// import axios from 'axios';\n// import { useParams } from \"react-router-dom\";\n// import fontkit from '@pdf-lib/fontkit';\n// import THSarabunBold from '../../fonts/THSarabunBold.ttf'; // ปรับปรุงพาธตามที่เหมาะสม\n// import PDF from './Contract.pdf'\n// import { PDFDocument, rgb } from 'pdf-lib';\n// import dayjs from 'dayjs';\n// import 'dayjs/locale/th';\n// import customParseFormat from 'dayjs/plugin/customParseFormat';\n// // import { NumericFormat } from 'react-number-format';\n// import { useNavigate } from 'react-router-dom';\n// // import img from './ex.png'\n\n// dayjs.extend(customParseFormat);\n// dayjs.locale('th'); \n\n// const ReceiptCon = () => {\n//   const [books, setBooks] = useState([]);\n//   const [users, setUsers] = useState([]);\n//   const [houses, setHouse] = useState([]);\n//   const [profile, setProfile] = useState([]);\n//   const [contract, setContract] = useState([]);\n//   const { Bid } = useParams();\n\n//   useEffect(() => {\n//     loadBookingData();\n//   }, []);\n\n//   // const navigate = useNavigate();\n//   const loadBookingData = () => {\n//     axios.post(`http://26.90.237.200:3000/book/read/id`, { id: Bid })\n//       .then(response => {\n//         setBooks(response.data);\n//         // เมื่อได้รับข้อมูลการจองแล้ว ให้โหลดข้อมูลผู้ใช้ที่เกี่ยวข้องกับข้อมูลการจอง\n//         if (response.data.length > 0) {\n//           loadUserData(response.data[0].user_id);\n//           loadHouse(response.data[0].h_id);\n//           loadContract(response.data[0].b_id);\n//           // console.log(response.data[0].h_id)\n//         }\n//       })\n//       .catch(error => {\n//         console.error(error);\n//       });\n//   };\n\n//   const loadContract = (ContractId) => {\n//     axios.post(`http://26.90.237.200:3000/contract/read/id`, { id: ContractId })\n//       .then(response => {\n//         setContract(response.data);\n//         // console.log(response.data)\n//       })\n//       .catch(error => {\n//         console.error('เกิดข้อผิดพลาดในการดึงข้อมูล:', error);\n//       });\n//   };\n// // console.log(contract);\n\n//   const loadHouse = (houseId) => {\n//     axios.post(`http://26.90.237.200:3000/admin/house/read/id`, { id: houseId })\n//       .then(response => {\n//         setHouse(response.data);\n//         // console.log(response.data)\n//       })\n//       .catch(error => {\n//         console.error('เกิดข้อผิดพลาดในการดึงข้อมูล:', error);\n//       });\n//   };\n\n//   useEffect(() => {\n//     axios.get('http://26.90.237.200:3000/admin/read')\n//       .then(response => {\n//         setProfile(response.data);\n//       })\n//       .catch(error => {\n//         console.error(error);\n//       });\n\n//   }, []);\n\n//   const loadUserData = (userId) => {\n//     axios.post(`http://26.90.237.200:3000/user/read/id`, { id: userId })\n//       .then(response => {\n//         setUsers(response.data);\n//         // console.log(response.data)\n//       })\n//       .catch(error => {\n//         console.error(error);\n//       });\n//   };\n\n//   const generatePdf = async () => {\n//     try {\n//       const existingPdfBytes = await fetch(PDF).then(res => res.arrayBuffer())\n//       const pdfDoc = await PDFDocument.load(existingPdfBytes);\n//       pdfDoc.registerFontkit(fontkit);\n//       const fontBytes = await axios.get(THSarabunBold, { responseType: 'arraybuffer' }); \n//       const font = await pdfDoc.embedFont(fontBytes.data); \n\n//       const page = pdfDoc.getPages()[0];\n//       let y = 780;\n//       const relatedbook = books[0];\n//       const relatedUser = users[0];\n//       const relatedHouse = houses[0];\n//       const relatedCon = contract[0];\n//       const date = dayjs();\n//       const day = date.format('DD');\n//       const month = date.format('MMMM');\n//       const year = parseInt(date.format('YYYY')) + 543;\n//       let thaiBahtText = require('thai-baht-text');\n//       let priceInThai = thaiBahtText(relatedHouse.book_price);\n//       const bookingDate = relatedCon.date && dayjs(relatedbook.date_contract).add(543, 'year').format('DD MMMM YYYY');\n\n//       // page.drawText(` ${relatedUser.user_name}  ${relatedUser.user_lastname}`, { x: 110, y: y - 589, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${relatedHouse.h_id}`, { x: 348, y: y - 618, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${relatedHouse.book_price.toLocaleString()} `, { x: 110, y: y - 676, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${priceInThai} `, { x: 285, y: y - 677, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${day}    ${month}    ${year}`, { x: 285, y: y - 574, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${profile[0].manager_name}  ${profile[0].manager_lastname}`, { x: 100, y: y - 724, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${profile[0].address} `, { x: 75, y: y - 603, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${profile[0].phone} `, { x: 110, y: y - 617, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${profile[0].name} `, { x: 180, y: y - 547, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${profile[0].md_name} `, { x: 296, y: y - 724, size: 9, font, color: rgb(0, 0, 0), });\n//       // page.drawText(` ${relatedCon[0].b_id}`, { x: 285, y: y - 574, size: 9, font, color: rgb(0, 0, 0), });\n//       page.drawText(` ${bookingDate} `, { x: 265, y: y - 54, size: 15, font, color: rgb(1, 0, 0), });\n\n//       page.drawText(` ${profile[0].company} `, { x: 100, y: y - 94, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${relatedCon.b_id} `, { x: 500, y: y - -23, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${profile[0].md_name} `, { x: 265, y: y - 94, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${profile[0].md_nationality} `, { x: 469, y: y - 94, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${profile[0].md_address} `, { x: 50, y: y - 114, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${profile[0].phone} `, { x: 420, y: y - 114, size: 15, font, color: rgb(1, 0, 0), });\n\n//       page.drawText(` ${relatedUser.user_name}  ${relatedUser.user_lastname}`, { x: 96, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${relatedUser.user_age}`, { x: 203, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${relatedUser.nationality}`, { x: 260, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${relatedUser.user_address}`, { x: 325, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\n//       page.drawText(` ${relatedUser.user_address}`, { x: 325, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\n\n//       const modifiedAddress = profile[0].md_address.replace(\"อำเภอเมือง\", \"\\nอำเภอเมือง\");\n//       const addressLines = modifiedAddress.split('\\n');\n//       let currentY = y - 20;\n//       addressLines.forEach((line) => {\n//         const lineWidth = font.widthOfTextAtSize(line, 15); // calculate the width of the text\n//         page.drawText(line, { x: 534 - lineWidth, y: currentY, size: 15, font, color: rgb(1, 0, 0) });\n//         currentY -= 20;\n//       });\n\n//       const pdfBytes = await pdfDoc.save();\n//       const pdfUrl = URL.createObjectURL(new Blob([pdfBytes], { type: 'application/pdf' }));\n//       window.open(pdfUrl, 'blank');\n//       // navigate('/Booking');\n//     } catch (error) {\n//       console.error(error);\n//     }\n//   };\n\n//   return (\n//     <div className=\"container\">\n//       <button type=\"button\" className=\"btn btn-primary\" onClick={generatePdf}>\n//       บันทึกเป็น PDF\n//     </button>\n//     </div>\n//   );\n// };\n\n// export default ReceiptCon;","map":{"version":3,"names":[],"sources":["C:/Users/TongNPZ/Desktop/my-app-2.0/src/components/Receipt/ReceiptCon.js"],"sourcesContent":["// import React, { useEffect, useState } from 'react';\r\n// import axios from 'axios';\r\n// import { useParams } from \"react-router-dom\";\r\n// import fontkit from '@pdf-lib/fontkit';\r\n// import THSarabunBold from '../../fonts/THSarabunBold.ttf'; // ปรับปรุงพาธตามที่เหมาะสม\r\n// import PDF from './Contract.pdf'\r\n// import { PDFDocument, rgb } from 'pdf-lib';\r\n// import dayjs from 'dayjs';\r\n// import 'dayjs/locale/th';\r\n// import customParseFormat from 'dayjs/plugin/customParseFormat';\r\n// // import { NumericFormat } from 'react-number-format';\r\n// import { useNavigate } from 'react-router-dom';\r\n// // import img from './ex.png'\r\n\r\n// dayjs.extend(customParseFormat);\r\n// dayjs.locale('th'); \r\n\r\n// const ReceiptCon = () => {\r\n//   const [books, setBooks] = useState([]);\r\n//   const [users, setUsers] = useState([]);\r\n//   const [houses, setHouse] = useState([]);\r\n//   const [profile, setProfile] = useState([]);\r\n//   const [contract, setContract] = useState([]);\r\n//   const { Bid } = useParams();\r\n\r\n//   useEffect(() => {\r\n//     loadBookingData();\r\n//   }, []);\r\n  \r\n//   // const navigate = useNavigate();\r\n//   const loadBookingData = () => {\r\n//     axios.post(`http://26.90.237.200:3000/book/read/id`, { id: Bid })\r\n//       .then(response => {\r\n//         setBooks(response.data);\r\n//         // เมื่อได้รับข้อมูลการจองแล้ว ให้โหลดข้อมูลผู้ใช้ที่เกี่ยวข้องกับข้อมูลการจอง\r\n//         if (response.data.length > 0) {\r\n//           loadUserData(response.data[0].user_id);\r\n//           loadHouse(response.data[0].h_id);\r\n//           loadContract(response.data[0].b_id);\r\n//           // console.log(response.data[0].h_id)\r\n//         }\r\n//       })\r\n//       .catch(error => {\r\n//         console.error(error);\r\n//       });\r\n//   };\r\n  \r\n//   const loadContract = (ContractId) => {\r\n//     axios.post(`http://26.90.237.200:3000/contract/read/id`, { id: ContractId })\r\n//       .then(response => {\r\n//         setContract(response.data);\r\n//         // console.log(response.data)\r\n//       })\r\n//       .catch(error => {\r\n//         console.error('เกิดข้อผิดพลาดในการดึงข้อมูล:', error);\r\n//       });\r\n//   };\r\n// // console.log(contract);\r\n\r\n//   const loadHouse = (houseId) => {\r\n//     axios.post(`http://26.90.237.200:3000/admin/house/read/id`, { id: houseId })\r\n//       .then(response => {\r\n//         setHouse(response.data);\r\n//         // console.log(response.data)\r\n//       })\r\n//       .catch(error => {\r\n//         console.error('เกิดข้อผิดพลาดในการดึงข้อมูล:', error);\r\n//       });\r\n//   };\r\n  \r\n//   useEffect(() => {\r\n//     axios.get('http://26.90.237.200:3000/admin/read')\r\n//       .then(response => {\r\n//         setProfile(response.data);\r\n//       })\r\n//       .catch(error => {\r\n//         console.error(error);\r\n//       });\r\n\r\n//   }, []);\r\n\r\n//   const loadUserData = (userId) => {\r\n//     axios.post(`http://26.90.237.200:3000/user/read/id`, { id: userId })\r\n//       .then(response => {\r\n//         setUsers(response.data);\r\n//         // console.log(response.data)\r\n//       })\r\n//       .catch(error => {\r\n//         console.error(error);\r\n//       });\r\n//   };\r\n\r\n//   const generatePdf = async () => {\r\n//     try {\r\n//       const existingPdfBytes = await fetch(PDF).then(res => res.arrayBuffer())\r\n//       const pdfDoc = await PDFDocument.load(existingPdfBytes);\r\n//       pdfDoc.registerFontkit(fontkit);\r\n//       const fontBytes = await axios.get(THSarabunBold, { responseType: 'arraybuffer' }); \r\n//       const font = await pdfDoc.embedFont(fontBytes.data); \r\n  \r\n//       const page = pdfDoc.getPages()[0];\r\n//       let y = 780;\r\n//       const relatedbook = books[0];\r\n//       const relatedUser = users[0];\r\n//       const relatedHouse = houses[0];\r\n//       const relatedCon = contract[0];\r\n//       const date = dayjs();\r\n//       const day = date.format('DD');\r\n//       const month = date.format('MMMM');\r\n//       const year = parseInt(date.format('YYYY')) + 543;\r\n//       let thaiBahtText = require('thai-baht-text');\r\n//       let priceInThai = thaiBahtText(relatedHouse.book_price);\r\n//       const bookingDate = relatedCon.date && dayjs(relatedbook.date_contract).add(543, 'year').format('DD MMMM YYYY');\r\n\r\n//       // page.drawText(` ${relatedUser.user_name}  ${relatedUser.user_lastname}`, { x: 110, y: y - 589, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${relatedHouse.h_id}`, { x: 348, y: y - 618, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${relatedHouse.book_price.toLocaleString()} `, { x: 110, y: y - 676, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${priceInThai} `, { x: 285, y: y - 677, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${day}    ${month}    ${year}`, { x: 285, y: y - 574, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${profile[0].manager_name}  ${profile[0].manager_lastname}`, { x: 100, y: y - 724, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${profile[0].address} `, { x: 75, y: y - 603, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${profile[0].phone} `, { x: 110, y: y - 617, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${profile[0].name} `, { x: 180, y: y - 547, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${profile[0].md_name} `, { x: 296, y: y - 724, size: 9, font, color: rgb(0, 0, 0), });\r\n//       // page.drawText(` ${relatedCon[0].b_id}`, { x: 285, y: y - 574, size: 9, font, color: rgb(0, 0, 0), });\r\n//       page.drawText(` ${bookingDate} `, { x: 265, y: y - 54, size: 15, font, color: rgb(1, 0, 0), });\r\n\r\n//       page.drawText(` ${profile[0].company} `, { x: 100, y: y - 94, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${relatedCon.b_id} `, { x: 500, y: y - -23, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${profile[0].md_name} `, { x: 265, y: y - 94, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${profile[0].md_nationality} `, { x: 469, y: y - 94, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${profile[0].md_address} `, { x: 50, y: y - 114, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${profile[0].phone} `, { x: 420, y: y - 114, size: 15, font, color: rgb(1, 0, 0), });\r\n\r\n//       page.drawText(` ${relatedUser.user_name}  ${relatedUser.user_lastname}`, { x: 96, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${relatedUser.user_age}`, { x: 203, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${relatedUser.nationality}`, { x: 260, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${relatedUser.user_address}`, { x: 325, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\r\n//       page.drawText(` ${relatedUser.user_address}`, { x: 325, y: y - 154, size: 15, font, color: rgb(1, 0, 0), });\r\n\r\n//       const modifiedAddress = profile[0].md_address.replace(\"อำเภอเมือง\", \"\\nอำเภอเมือง\");\r\n//       const addressLines = modifiedAddress.split('\\n');\r\n//       let currentY = y - 20;\r\n//       addressLines.forEach((line) => {\r\n//         const lineWidth = font.widthOfTextAtSize(line, 15); // calculate the width of the text\r\n//         page.drawText(line, { x: 534 - lineWidth, y: currentY, size: 15, font, color: rgb(1, 0, 0) });\r\n//         currentY -= 20;\r\n//       });\r\n  \r\n//       const pdfBytes = await pdfDoc.save();\r\n//       const pdfUrl = URL.createObjectURL(new Blob([pdfBytes], { type: 'application/pdf' }));\r\n//       window.open(pdfUrl, 'blank');\r\n//       // navigate('/Booking');\r\n//     } catch (error) {\r\n//       console.error(error);\r\n//     }\r\n//   };\r\n\r\n//   return (\r\n//     <div className=\"container\">\r\n//       <button type=\"button\" className=\"btn btn-primary\" onClick={generatePdf}>\r\n//       บันทึกเป็น PDF\r\n//     </button>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ReceiptCon;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}